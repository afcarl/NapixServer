

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Install and deploy Napix &mdash; Napix 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Napix 0.1 documentation" href="index.html" />
    <link rel="next" title="Manager" href="managers.html" />
    <link rel="prev" title="Howto write a Napix module with the low level interface" href="low_level.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="managers.html" title="Manager"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="low_level.html" title="Howto write a Napix module with the low level interface"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Napix 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="install-and-deploy-napix">
<h1>Install and deploy Napix<a class="headerlink" href="#install-and-deploy-napix" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>The napix daemon needs</p>
<dl class="docutils">
<dt>bottle &gt; 0.10</dt>
<dd>Lightweight web framework</dd>
<dt>rocket</dt>
<dd>Threaded wsgi server</dd>
<dt>httplib2</dt>
<dd>Http client</dd>
<dt>redis-python (optional)</dt>
<dd>Redis client (for the shared store)</dd>
<dt>unittest2 (optional)</dt>
<dd>Test framework (for the unit tests)</dd>
<dt>pyinotify (optional)</dt>
<dd>Detection of file modification (automatic reloading of modified source files)</dd>
</dl>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Napix takes its configuration in the conf/settings.json.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;_napix_version&quot;</span><span class="o">:</span> <span class="mf">1.0</span> <span class="p">,</span>
  <span class="s2">&quot;Napix&quot;</span> <span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;debug&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;daemon&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;host&quot;</span> <span class="o">:</span> <span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;port&quot;</span> <span class="o">:</span> <span class="mi">8002</span>
    <span class="p">},</span>
    <span class="s2">&quot;loader&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;autoreload&quot;</span> <span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">&quot;storage&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;file&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span> <span class="o">:</span> <span class="s2">&quot;/tmp/napix&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;redis&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;host&quot;</span> <span class="o">:</span> <span class="s2">&quot;redis.napix.nx&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;auth&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;auth_url&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://localhost:8003/auth/authorization/&quot;</span><span class="p">,</span>
      <span class="s2">&quot;service&quot;</span> <span class="o">:</span> <span class="s2">&quot;localhost:8002&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;managers&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;hostfiles&quot;</span> <span class="o">:</span> <span class="s2">&quot;napixd.examples.list_manager.HostFiles&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;hostfiles&quot;</span> <span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;sample&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="napix-daemon">
<h3>Napix.daemon<a class="headerlink" href="#napix-daemon" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">Napix.daemon</span></tt> key sets the listen address and port.</p>
</div>
<div class="section" id="napix-auth">
<h3>Napix.auth<a class="headerlink" href="#napix-auth" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">Napix.auth</span></tt> key sets the value of the authentication server.</p>
<p>The value <tt class="docutils literal"><span class="pre">service</span></tt> is the <strong>public address</strong> at which the Napix server is accessed.
The client will sign its request with this public address.
The Napix server will check that it is the host at which the request is addressed by comparing its host value and the request host.</p>
<p>The <tt class="docutils literal"><span class="pre">auth_url</span></tt> value will set the address at which the server will ask for the confirmation of the requests authenticity.</p>
</div>
</div>
<div class="section" id="modules-loading">
<h2>Modules Loading<a class="headerlink" href="#modules-loading" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading-by-the-configuration">
<h3>Loading by the configuration<a class="headerlink" href="#loading-by-the-configuration" title="Permalink to this headline">¶</a></h3>
<p>The configuration object <tt class="docutils literal"><span class="pre">Napix.managers</span></tt> is a hashmap
where the keys are an alias and the value is the dotted python path to a Manager.
Multiple instance of a single manager class can be loaded, with different aliases.
The detect (cf <a class="reference internal" href="#auto-loading"><em>Auto-loading</em></a>) classmethod is not called.</p>
<p>In order to specify the configuration for an instance of a Manager,
you can add a value in the root object of the configuration.</p>
<p>In this example, two X480 are managed by this Napix server, they use the same manager, and different IP and credentials.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;Napix&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;managers&quot;</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;router1&quot;</span> <span class="o">:</span> <span class="s2">&quot;enix.managers.routers.ManagerForX480&quot;</span><span class="p">,</span>
            <span class="s2">&quot;router2&quot;</span> <span class="o">:</span> <span class="s2">&quot;enix.managers.routers.ManagerForX480&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;router1&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span> <span class="o">:</span> <span class="s2">&quot;10.20.40.254&quot;</span><span class="p">,</span>
        <span class="s2">&quot;login&quot;</span> <span class="o">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;password&quot;</span> <span class="o">:</span> <span class="s2">&quot;wE%RZ34$mm&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;router2&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span> <span class="o">:</span> <span class="s2">&quot;10.20.45.254&quot;</span><span class="p">,</span>
        <span class="s2">&quot;login&quot;</span> <span class="o">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;password&quot;</span> <span class="o">:</span> <span class="s2">&quot;mp2*SD16$p&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="auto-loading">
<span id="id1"></span><h3>Auto-loading<a class="headerlink" href="#auto-loading" title="Permalink to this headline">¶</a></h3>
<p>If there is a file ending by <strong>.py</strong> in a auto-detect folder
of the Napix setup (/var/lib/napix/auto or NapixServer/auto),
the Napix loader will import this python file and add all the subclasses of <a class="reference internal" href="managers.html#managers.Manager" title="managers.Manager"><tt class="xref py py-class docutils literal"><span class="pre">managers.Manager</span></tt></a> in the available managers.
The auto loaded managers may override the classmethod <a class="reference internal" href="managers.html#managers.Manager.detect" title="managers.Manager.detect"><tt class="xref py py-meth docutils literal"><span class="pre">detect()</span></tt></a>
which tells if the managers should be loaded.
By default detect return True when the class is not a base method defined inside Napix.</p>
<p>This feature does not allow neither multiple loading of the same manager nor the configuration.</p>
</div>
<div class="section" id="reloading">
<h3>Reloading<a class="headerlink" href="#reloading" title="Permalink to this headline">¶</a></h3>
<p>Napix proposes an option to reload the modules without stopping the server.
When the reload is triggered, the configuration is reparsed.
The autoload directories are scanned again.</p>
<p>The automatic reloading is disabled when Napix.loader.reload is set to false.</p>
<div class="section" id="get-napix-reload">
<h4>GET /_napix_reload<a class="headerlink" href="#get-napix-reload" title="Permalink to this headline">¶</a></h4>
<p>When the server is on DEBUG mode, a simple GET on /_napix_reload will trigger a reload.
It is useful for a developer, he just refreshes /_napix_reload then refreshes his page.</p>
</div>
<div class="section" id="send-a-sighup-signal">
<h4>Send a SIGHUP signal<a class="headerlink" href="#send-a-sighup-signal" title="Permalink to this headline">¶</a></h4>
<p>Sending a SIGHUP to the server will cause it to reload.</p>
<div class="highlight-none"><div class="highlight"><pre>$ ps aux  | grep napixd
napixd     13651  0.5  2.4  81000 12560 pts/3    Sl+  05:24   0:17 python bin/napixd
$ kill -HUP 13651
</pre></div>
</div>
</div>
<div class="section" id="use-inotify">
<h4>Use inotify<a class="headerlink" href="#use-inotify" title="Permalink to this headline">¶</a></h4>
<p>When inotify is available, it will listen on the filesystem to check if the auto-loaded directories changed,
and it will then issue a reload.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Install and deploy Napix</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#napix-daemon">Napix.daemon</a></li>
<li><a class="reference internal" href="#napix-auth">Napix.auth</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modules-loading">Modules Loading</a><ul>
<li><a class="reference internal" href="#loading-by-the-configuration">Loading by the configuration</a></li>
<li><a class="reference internal" href="#auto-loading">Auto-loading</a></li>
<li><a class="reference internal" href="#reloading">Reloading</a><ul>
<li><a class="reference internal" href="#get-napix-reload">GET /_napix_reload</a></li>
<li><a class="reference internal" href="#send-a-sighup-signal">Send a SIGHUP signal</a></li>
<li><a class="reference internal" href="#use-inotify">Use inotify</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="low_level.html"
                        title="previous chapter">Howto write a Napix module with the low level interface</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="managers.html"
                        title="next chapter">Manager</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/deployment.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="managers.html" title="Manager"
             >next</a> |</li>
        <li class="right" >
          <a href="low_level.html" title="Howto write a Napix module with the low level interface"
             >previous</a> |</li>
        <li><a href="index.html">Napix 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Grégoire ROCHER.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>