/* A JavaScript implementation of the SHA family of hashes, as defined in FIPS
 * PUB 180-2 as well as the corresponding HMAC implementation as defined in
 * FIPS PUB 198a
 *
 * Version 1.3 Copyright Brian Turek 2008-2010
 * Distributed under the BSD License
 * See http://jssha.sourceforge.net/ for more information
 *
 * Several functions taken from Paul Johnson
 */

(function(){var e=8,t="",n=0,r=function(t){var n=[],r=(1<<e)-1,i=t.length*e,s;for(s=0;s<i;s+=e)n[s>>5]|=(t.charCodeAt(s/e)&r)<<32-e-s%32;return n},i=function(e){var t=[],n=e.length,r,i;for(r=0;r<n;r+=2){i=parseInt(e.substr(r,2),16);if(!!isNaN(i))return"INVALID HEX STRING";t[r>>3]|=i<<24-4*(r%8)}return t},s=function(e){var t=n?"0123456789ABCDEF":"0123456789abcdef",r="",i=e.length*4,s,o;for(s=0;s<i;s+=1)o=e[s>>2]>>(3-s%4)*8,r+=t.charAt(o>>4&15)+t.charAt(o&15);return r},o=function(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",i=e.length*4,s,o,u;for(s=0;s<i;s+=3){u=(e[s>>2]>>8*(3-s%4)&255)<<16|(e[s+1>>2]>>8*(3-(s+1)%4)&255)<<8|e[s+2>>2]>>8*(3-(s+2)%4)&255;for(o=0;o<4;o+=1)s*8+o*6<=e.length*32?r+=n.charAt(u>>6*(3-o)&63):r+=t}return r},u=function(e,t){return e>>>t|e<<32-t},a=function(e,t){return e>>>t},f=function(e,t,n){return e&t^~e&n},l=function(e,t,n){return e&t^e&n^t&n},c=function(e){return u(e,2)^u(e,13)^u(e,22)},h=function(e){return u(e,6)^u(e,11)^u(e,25)},p=function(e){return u(e,7)^u(e,18)^a(e,3)},d=function(e){return u(e,17)^u(e,19)^a(e,10)},v=function(e,t){var n=(e&65535)+(t&65535),r=(e>>>16)+(t>>>16)+(n>>>16);return(r&65535)<<16|n&65535},m=function(e,t,n,r){var i=(e&65535)+(t&65535)+(n&65535)+(r&65535),s=(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16);return(s&65535)<<16|i&65535},g=function(e,t,n,r,i){var s=(e&65535)+(t&65535)+(n&65535)+(r&65535)+(i&65535),o=(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16)+(s>>>16);return(o&65535)<<16|s&65535},y=function(e,t,n){var r,i,s,o,u,a,y,b,w,E,S,x,T,N,C,k=[],L;if(n==="SHA-224"||n==="SHA-256")x=(t+65>>9<<4)+15,C=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n==="SHA-224"?S=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]:S=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];e[t>>5]|=128<<24-t%32,e[x]=t,L=e.length;for(T=0;T<L;T+=16){r=S[0],i=S[1],s=S[2],o=S[3],u=S[4],a=S[5],y=S[6],b=S[7];for(N=0;N<64;N+=1)N<16?k[N]=e[N+T]:k[N]=m(d(k[N-2]),k[N-7],p(k[N-15]),k[N-16]),w=g(b,h(u),f(u,a,y),C[N],k[N]),E=v(c(r),l(r,i,s)),b=y,y=a,a=u,u=v(o,w),o=s,s=i,i=r,r=v(w,E);S[0]=v(r,S[0]),S[1]=v(i,S[1]),S[2]=v(s,S[2]),S[3]=v(o,S[3]),S[4]=v(u,S[4]),S[5]=v(a,S[5]),S[6]=v(y,S[6]),S[7]=v(b,S[7])}switch(n){case"SHA-224":return[S[0],S[1],S[2],S[3],S[4],S[5],S[6]];case"SHA-256":return S;default:return[]}},b=function(t,n){this.sha224=null,this.sha256=null,this.strBinLen=null,this.strToHash=null;if("HEX"===n){if(0!==t.length%2)return"TEXT MUST BE IN BYTE INCREMENTS";this.strBinLen=t.length*4,this.strToHash=i(t)}else{if("ASCII"!==n&&"undefined"!=typeof n)return"UNKNOWN TEXT INPUT TYPE";this.strBinLen=t.length*e,this.strToHash=r(t)}};b.prototype={getHash:function(e,t){var n=null,r=this.strToHash.slice();switch(t){case"HEX":n=s;break;case"B64":n=o;break;default:return"FORMAT NOT RECOGNIZED"}switch(e){case"SHA-224":return null===this.sha224&&(this.sha224=y(r,this.strBinLen,e)),n(this.sha224);case"SHA-256":return null===this.sha256&&(this.sha256=y(r,this.strBinLen,e)),n(this.sha256);default:return"HASH NOT RECOGNIZED"}},getHMAC:function(t,n,u,a){var f,l,c,h,p,d,v=[],m=[];switch(a){case"HEX":f=s;break;case"B64":f=o;break;default:return"FORMAT NOT RECOGNIZED"}switch(u){case"SHA-224":d=224;break;case"SHA-256":d=256;break;default:return"HASH NOT RECOGNIZED"}if("HEX"===n){if(0!==t.length%2)return"KEY MUST BE IN BYTE INCREMENTS";l=i(t),p=t.length*4}else{if("ASCII"!==n)return"UNKNOWN KEY INPUT TYPE";l=r(t),p=t.length*e}64<p/8?(l=y(l,p,u),l[15]&=4294967040):64>p/8&&(l[15]&=4294967040);for(c=0;c<=15;c+=1)v[c]=l[c]^909522486,m[c]=l[c]^1549556828;return h=y(v.concat(this.strToHash),512+this.strBinLen,u),h=y(m.concat(h),512+d,u),f(h)}},window.jsSHA=b})()