define("selectors",["underscore","Backbone","jQuery","models/servers","models/credentials","mustache"],function(a,b,c,d,e,f){var g=b.View.extend({tagName:"li",template:f.compile('<li ><a href="#">{{.}}</a><i class="icon-remove pull-right"/></li>'),initialize:function(){this.model.bind("change",this.setSelected,this),this.model.bind("destroy",this.remove,this),this.$el.on("click","a",this.model.select.bind(this.model)).on("click","i.icon-remove",this.model.destroy.bind(this.model))},render:function(){return this.$el.append(this.template(this.model.toString())),this.setSelected(),this},setSelected:function(){this.$el.toggleClass("selected",this.model.get("selected"))},remove:function(){this.$el.remove()}}),h=b.View.extend({ItemView:g,initialize:function(){this.setElement(c("#"+this.prefix)),this.collection.bind("reset",this.ensureDefault,this),this.collection.bind("reset",this.addAll,this),this.collection.bind("reset",this.selectDefault,this),this.hidePrompt(),c("#"+this.prefix+"-plus .add").click(this.showPrompt.bind(this)),c("#"+this.prefix+"-prompt").keypress(this.updateOnEnter.bind(this)),c("#"+this.prefix+"-prompt .go").click(this.addItem.bind(this)),c("#"+this.prefix+"-prompt .cancel").click(a.bind(this.trigger,this,"finished")),this.collection.fetch(),this.collection.bind("add",this.addOne,this),this.bind("finished",this.hidePrompt,this)},selectDefault:function(){this.collection.size()&&!this.collection.any(function(a){return a.get("selected")})&&this.collection.first().select()},addAll:function(){this.collection.each(this.addOne,this)},addOne:function(a){a.bind("selected",this.select),this.$("#"+this.prefix+"-body").append((new this.ItemView({model:a})).render().el)},hidePrompt:function(){this.$("#"+this.prefix+"-prompt").hide(),this.$("#"+this.prefix+"-plus").show()},showPrompt:function(){this.$("#"+this.prefix+"-prompt").show().first().find("input").attr("value","").focus(),this.$("#"+this.prefix+"-plus").hide()},updateOnEnter:function(a){a.keyCode===13?this.addItem():a.keyCode===27&&this.trigger("finished")},addItem:function(){var b=a(this.$("input").toArray()).chain().map(function(a){return c(a)}).map(function(a){return[a.prop("name"),a.prop("value")]}).objectify().value(),d=this.collection.create(b);d&&(this.trigger("finished"),d.select())}}),i=h.extend({collection:d,prefix:"connections-servers",ensureDefault:function(){this.collection.any(function(a){return a.get("host")===location.host})||this.collection.create({host:location.host})}}),j=h.extend({collection:e,prefix:"connections-credentials",ensureDefault:function(){this.collection.any(function(a){return a.get("pass")==="_napix_noauth"})||this.collection.create({login:"No auth (debug)",pass:"_napix_noauth"})}}),k=b.View.extend({initialize:function(){this.serverSelector=new i,this.loginSelector=new j}});return k})